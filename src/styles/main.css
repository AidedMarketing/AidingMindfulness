@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  * {
    @apply box-border;
  }

  html, body {
    @apply h-full w-full m-0 p-0;
  }

  /* Light mode (default) */
  body {
    @apply font-sans bg-cream text-dark-brown antialiased;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    transition: background-color 0.3s ease, color 0.3s ease;
  }

  /* Dark mode */
  body.dark {
    @apply bg-charcoal text-warm-white;
  }

  button {
    @apply cursor-pointer;
  }

  /* Text selection */
  ::selection {
    @apply bg-ember/30;
  }

  body.dark ::selection {
    @apply bg-soft-ember/30;
  }
}

@layer components {
  /* Primary button */
  .btn-primary {
    @apply px-6 py-4 bg-ember text-white rounded-xl font-medium
           hover:bg-ember/90 transition-all duration-200
           active:scale-95 transform
           min-h-[48px] shadow-sm;
  }

  body.dark .btn-primary {
    @apply bg-soft-ember hover:bg-soft-ember/90;
  }

  /* Secondary button */
  .btn-secondary {
    @apply px-6 py-4 bg-transparent border-2 border-muted-text text-dark-brown
           rounded-xl font-medium
           hover:bg-muted-text/10 transition-all duration-200
           active:scale-95 transform
           min-h-[48px];
  }

  body.dark .btn-secondary {
    @apply border-muted-dark text-warm-white hover:bg-muted-dark/10;
  }

  /* Text input */
  .input-text {
    @apply w-full px-4 py-3 bg-transparent
           border-b-2 border-muted-text/30
           focus:border-ember focus:outline-none
           transition-colors duration-200
           text-lg;
  }

  body.dark .input-text {
    @apply border-muted-dark/30 focus:border-soft-ember;
  }

  /* Page container */
  .page-container {
    @apply min-h-screen w-full flex flex-col items-center justify-center p-6;
  }

  /* Modal overlay */
  .modal-overlay {
    @apply fixed inset-0 bg-dark-brown/50 backdrop-blur-sm
           flex items-center justify-center p-4 z-50;
  }

  body.dark .modal-overlay {
    @apply bg-charcoal/70;
  }

  /* Modal content */
  .modal-content {
    @apply bg-cream rounded-2xl p-8 max-w-md w-full shadow-2xl;
  }

  body.dark .modal-content {
    @apply bg-charcoal border border-muted-dark/30;
  }

  /* Calendar day */
  .calendar-day {
    @apply w-12 h-12 flex items-center justify-center
           rounded-lg cursor-pointer
           transition-all duration-150
           hover:bg-muted-text/10;
  }

  body.dark .calendar-day {
    @apply hover:bg-muted-dark/10;
  }

  .calendar-day.today {
    @apply ring-2 ring-ember;
  }

  body.dark .calendar-day.today {
    @apply ring-soft-ember;
  }

  .calendar-day.has-entry {
    @apply font-semibold;
  }

  /* Emotion button in radial picker */
  .emotion-btn {
    @apply flex flex-col items-center justify-center
           p-3 rounded-full
           transition-all duration-150
           hover:scale-110 active:scale-95
           cursor-pointer;
  }

  /* Top bar */
  .top-bar {
    @apply fixed top-0 left-0 right-0
           flex items-center justify-between
           px-6 py-4 z-40
           transition-all duration-300;
  }

  .top-bar.hidden {
    @apply opacity-0 pointer-events-none transform -translate-y-full;
  }

  .top-bar.visible {
    @apply opacity-100 pointer-events-auto transform translate-y-0;
  }
}

@layer utilities {
  /* Text area auto-resize */
  .textarea-autoresize {
    resize: none;
    overflow-y: hidden;
  }

  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Touch-friendly */
  .touch-target {
    @apply min-w-[44px] min-h-[44px];
  }

  /* Word count display */
  .word-count {
    @apply text-sm text-muted-text;
  }

  body.dark .word-count {
    @apply text-muted-dark;
  }
}

/* Burning animation effects */
.burning-page {
  position: relative;
  will-change: transform, filter, opacity;
}

.burning-page::before {
  content: '';
  position: absolute;
  inset: -10px;
  background: radial-gradient(circle,
    rgba(225, 112, 85, 0.4) 0%,
    rgba(225, 112, 85, 0.2) 40%,
    transparent 70%
  );
  opacity: 0;
  pointer-events: none;
  animation: fire-glow 3.5s ease-out forwards;
}

body.dark .burning-page::before {
  background: radial-gradient(circle,
    rgba(255, 138, 101, 0.4) 0%,
    rgba(255, 138, 101, 0.2) 40%,
    transparent 70%
  );
}

@keyframes fire-glow {
  0% { opacity: 0; }
  30% { opacity: 1; }
  100% { opacity: 0; }
}

/* Fade transitions */
.fade-enter {
  opacity: 0;
}

.fade-enter-active {
  opacity: 1;
  transition: opacity 300ms ease-in;
}

.fade-exit {
  opacity: 1;
}

.fade-exit-active {
  opacity: 0;
  transition: opacity 300ms ease-out;
}

/* Slide up (for modals) */
@keyframes slide-up {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slide-down {
  from {
    transform: translateY(0);
    opacity: 1;
  }
  to {
    transform: translateY(100%);
    opacity: 0;
  }
}

.animate-slide-up {
  animation: slide-up 400ms ease-out forwards;
}

.animate-slide-down {
  animation: slide-down 300ms ease-in forwards;
}

/* Loading spinner */
.spinner {
  border: 3px solid rgba(225, 112, 85, 0.1);
  border-top-color: #E17055;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
}

body.dark .spinner {
  border-color: rgba(255, 138, 101, 0.1);
  border-top-color: #FF8A65;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* Disable text selection during burning animation */
.burning-page * {
  user-select: none;
  -webkit-user-select: none;
}

/* ========== BURNING ANIMATION EFFECTS ========== */

/* Realistic flame animations */
.flame {
  position: absolute;
  bottom: 0;
  width: 80px;
  height: 120px;
  background: linear-gradient(to top,
    #FF4500 0%,
    #FF6347 30%,
    #FFA500 60%,
    #FFD700 80%,
    transparent 100%
  );
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  filter: blur(8px);
  animation: flicker 0.3s infinite alternate;
  opacity: 0.9;
}

.flame-1 {
  left: 10%;
  animation-delay: 0s;
  animation-duration: 0.25s;
}

.flame-2 {
  left: 30%;
  animation-delay: 0.1s;
  animation-duration: 0.35s;
  height: 140px;
}

.flame-3 {
  left: 50%;
  animation-delay: 0.05s;
  animation-duration: 0.3s;
  height: 160px;
}

.flame-4 {
  left: 70%;
  animation-delay: 0.15s;
  animation-duration: 0.28s;
  height: 130px;
}

.flame-5 {
  right: 10%;
  animation-delay: 0.08s;
  animation-duration: 0.32s;
}

@keyframes flicker {
  0% {
    transform: scaleY(1) scaleX(0.95) translateY(0);
    opacity: 0.85;
  }
  50% {
    transform: scaleY(1.1) scaleX(1) translateY(-5px);
    opacity: 0.95;
  }
  100% {
    transform: scaleY(0.95) scaleX(1.05) translateY(-2px);
    opacity: 0.9;
  }
}

/* Smoke effect */
.smoke {
  position: absolute;
  width: 100px;
  height: 100px;
  background: radial-gradient(circle, rgba(100, 100, 100, 0.4), transparent 70%);
  border-radius: 50%;
  filter: blur(20px);
  animation: smoke-rise 4s ease-out infinite;
}

.smoke-1 {
  left: 20%;
  bottom: 60%;
  animation-delay: 0s;
}

.smoke-2 {
  left: 50%;
  bottom: 60%;
  animation-delay: 0.8s;
}

.smoke-3 {
  left: 75%;
  bottom: 60%;
  animation-delay: 1.6s;
}

@keyframes smoke-rise {
  0% {
    transform: translateY(0) scale(0.8);
    opacity: 0.6;
  }
  50% {
    transform: translateY(-80px) scale(1.2);
    opacity: 0.3;
  }
  100% {
    transform: translateY(-150px) scale(1.5);
    opacity: 0;
  }
}

/* Glowing ember particles */
@keyframes ember-float {
  0% {
    transform: translateY(0) translateX(0) scale(1) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  80% {
    opacity: 0.8;
  }
  100% {
    transform: translateY(-200px) translateX(calc(-50px + (random() * 100px))) scale(0.3) rotate(360deg);
    opacity: 0;
  }
}

/* Ash floating animation */
@keyframes ash-float {
  0% {
    transform: translateY(0) translateX(0) scale(1);
    opacity: 0.7;
  }
  50% {
    opacity: 0.4;
  }
  100% {
    transform: translateY(-250px) translateX(calc(-40px + (random() * 80px))) scale(0.4);
    opacity: 0;
  }
}
